<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Information - LifeNivesh</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <img src="../logo.svg" alt="LifeNivesh Logo" class="logo">
                <span>LifeNivesh</span>
            </div>
            <div class="nav-links" id="nav-links" style="display: none;">
                <a href="../index.html" class="nav-link">Dashboard</a>
                <a href="networth.html" class="nav-link">Net Worth</a>
                <a href="income.html" class="nav-link">Income</a>
                <a href="expenses.html" class="nav-link">Expenses</a>
                <a href="ff-score.html" class="nav-link">FF Score</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container">
        <div class="page-header">
            <h1>Welcome to LifeNivesh</h1>
            <p class="text-secondary">Let's get started by setting up your profile</p>
        </div>

        <!-- Progress Steps -->
        <div class="onboarding-progress">
            <div class="progress-step active" data-step="1">
                <div class="step-icon">
                    <i class="fas fa-user"></i>
                </div>
                <div class="step-content">
                    <span class="step-label">Basic Info</span>
                    <span class="step-desc">Personal details</span>
                </div>
            </div>
            <div class="progress-step" data-step="2">
                <div class="step-icon">
                    <i class="fas fa-briefcase"></i>
                </div>
                <div class="step-content">
                    <span class="step-label">Professional</span>
                    <span class="step-desc">Work details</span>
                </div>
            </div>
            <div class="progress-step" data-step="3">
                <div class="step-icon">
                    <i class="fas fa-bullseye"></i>
                </div>
                <div class="step-content">
                    <span class="step-label">Goals</span>
                    <span class="step-desc">Financial objectives</span>
                </div>
            </div>
        </div>

        <!-- Multi-step Form -->
        <div class="card">
            <form id="personal-info-form" class="multi-step-form">
                <!-- Step 1: Basic Information -->
                <div class="form-step active" data-step="1">
                    <div class="card-header">
                        <h2><i class="fas fa-user"></i> Basic Information</h2>
                        <p class="text-secondary">Tell us about yourself</p>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="name">Full Name</label>
                                <div class="input-group">
                                    <i class="fas fa-user input-icon"></i>
                                    <input type="text" id="name" name="name" required 
                                           placeholder="Enter your full name"
                                           data-validate="name">
                                </div>
                                <span class="validation-message"></span>
                            </div>

                            <div class="form-group">
                                <label for="age">Age</label>
                                <div class="input-group">
                                    <i class="fas fa-calendar input-icon"></i>
                                    <input type="number" id="age" name="age" min="18" max="100" required 
                                           placeholder="Enter your age"
                                           data-validate="age">
                                </div>
                                <span class="validation-message"></span>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="email">Email</label>
                                <div class="input-group">
                                    <i class="fas fa-envelope input-icon"></i>
                                    <input type="email" id="email" name="email" required 
                                           placeholder="Enter your email"
                                           data-validate="email">
                                </div>
                                <span class="validation-message"></span>
                            </div>

                            <div class="form-group">
                                <label for="phone">Phone Number</label>
                                <div class="input-group">
                                    <i class="fas fa-phone input-icon"></i>
                                    <input type="tel" id="phone" name="phone" required 
                                           placeholder="Enter your phone number"
                                           data-validate="phone"
                                           maxlength="10">
                                </div>
                                <span class="validation-message"></span>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-primary next-step">Continue <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Professional Information -->
                <div class="form-step" data-step="2">
                    <div class="card-header">
                        <h2><i class="fas fa-briefcase"></i> Professional Information</h2>
                        <p class="text-secondary">Tell us about your work</p>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="occupation">Occupation</label>
                                <div class="input-group">
                                    <i class="fas fa-briefcase input-icon"></i>
                                    <select id="occupation" name="occupation" required>
                                        <option value="">Select your occupation</option>
                                        <option value="salaried">Salaried Employee</option>
                                        <option value="business">Business Owner</option>
                                        <option value="professional">Professional</option>
                                        <option value="freelancer">Freelancer</option>
                                        <option value="retired">Retired</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <span class="validation-message"></span>
                            </div>

                            <div class="form-group">
                                <label for="experience">Work Experience (Years)</label>
                                <div class="input-group">
                                    <i class="fas fa-clock input-icon"></i>
                                    <input type="number" id="experience" name="experience" min="0" max="50" 
                                           placeholder="Years of experience"
                                           data-validate="experience">
                                </div>
                                <span class="validation-message"></span>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="city">City</label>
                                <div class="input-group">
                                    <i class="fas fa-map-marker-alt input-icon"></i>
                                    <input type="text" id="city" name="city" required 
                                           placeholder="Enter your city"
                                           data-validate="city">
                                </div>
                                <span class="validation-message"></span>
                            </div>

                            <div class="form-group">
                                <label for="income-range">Annual Income Range</label>
                                <div class="input-group">
                                    <i class="fas fa-rupee-sign input-icon"></i>
                                    <select id="income-range" name="income-range" required>
                                        <option value="">Select income range</option>
                                        <option value="0-5">Below ₹5 Lakhs</option>
                                        <option value="5-10">₹5-10 Lakhs</option>
                                        <option value="10-20">₹10-20 Lakhs</option>
                                        <option value="20-50">₹20-50 Lakhs</option>
                                        <option value="50+">Above ₹50 Lakhs</option>
                                    </select>
                                </div>
                                <span class="validation-message"></span>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary prev-step"><i class="fas fa-arrow-left"></i> Back</button>
                            <button type="button" class="btn btn-primary next-step">Continue <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Financial Goals -->
                <div class="form-step" data-step="3">
                    <div class="card-header">
                        <h2><i class="fas fa-bullseye"></i> Financial Goals</h2>
                        <p class="text-secondary">Select your financial objectives</p>
                    </div>
                    <div class="card-body">
                        <div class="goals-grid">
                            <div class="goal-card">
                                <input type="checkbox" id="goal-retirement" name="goals" value="retirement">
                                <label for="goal-retirement">
                                    <i class="fas fa-umbrella-beach"></i>
                                    <h3>Retirement Planning</h3>
                                    <p>Plan for a comfortable retirement</p>
                                </label>
                            </div>

                            <div class="goal-card">
                                <input type="checkbox" id="goal-investment" name="goals" value="investment">
                                <label for="goal-investment">
                                    <i class="fas fa-chart-line"></i>
                                    <h3>Investment Growth</h3>
                                    <p>Grow your wealth through investments</p>
                                </label>
                            </div>

                            <div class="goal-card">
                                <input type="checkbox" id="goal-debt" name="goals" value="debt">
                                <label for="goal-debt">
                                    <i class="fas fa-hand-holding-usd"></i>
                                    <h3>Debt Management</h3>
                                    <p>Manage and reduce your debts</p>
                                </label>
                            </div>

                            <div class="goal-card">
                                <input type="checkbox" id="goal-savings" name="goals" value="savings">
                                <label for="goal-savings">
                                    <i class="fas fa-piggy-bank"></i>
                                    <h3>Emergency Savings</h3>
                                    <p>Build emergency fund</p>
                                </label>
                            </div>

                            <div class="goal-card">
                                <input type="checkbox" id="goal-tax" name="goals" value="tax">
                                <label for="goal-tax">
                                    <i class="fas fa-file-invoice-dollar"></i>
                                    <h3>Tax Planning</h3>
                                    <p>Optimize your tax savings</p>
                                </label>
                            </div>

                            <div class="goal-card">
                                <input type="checkbox" id="goal-property" name="goals" value="property">
                                <label for="goal-property">
                                    <i class="fas fa-home"></i>
                                    <h3>Property Investment</h3>
                                    <p>Invest in real estate</p>
                                </label>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary prev-step"><i class="fas fa-arrow-left"></i> Back</button>
                            <button type="submit" class="btn btn-primary">Complete Profile <i class="fas fa-check"></i></button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </main>

    <script src="../js/utils.js"></script>
    <script src="../js/state.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('personal-info-form');
            const navLinks = document.getElementById('nav-links');
            const steps = document.querySelectorAll('.form-step');
            const progressSteps = document.querySelectorAll('.progress-step');

            // Form validation patterns
            const patterns = {
                name: /^[a-zA-Z\s]{2,50}$/,
                email: /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,
                phone: /^[0-9]{10}$/,
                city: /^[a-zA-Z\s]{2,50}$/
            };

            // Validation messages
            const messages = {
                name: 'Please enter a valid name (2-50 characters)',
                email: 'Please enter a valid email address',
                phone: 'Please enter a valid 10-digit phone number',
                city: 'Please enter a valid city name',
                age: 'Age must be between 18 and 100',
                experience: 'Experience must be between 0 and 50 years'
            };

            // Phone number formatting
            document.getElementById('phone').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length > 10) value = value.slice(0, 10);
                e.target.value = value;
            });

            // Input validation
            function validateInput(input) {
                const value = input.value;
                const type = input.dataset.validate;
                let isValid = true;
                let message = '';

                if (type === 'name') {
                    isValid = patterns.name.test(value);
                    message = messages.name;
                } else if (type === 'email') {
                    isValid = patterns.email.test(value);
                    message = messages.email;
                } else if (type === 'phone') {
                    isValid = patterns.phone.test(value);
                    message = messages.phone;
                } else if (type === 'city') {
                    isValid = patterns.city.test(value);
                    message = messages.city;
                } else if (type === 'age') {
                    isValid = value >= 18 && value <= 100;
                    message = messages.age;
                } else if (type === 'experience') {
                    isValid = value >= 0 && value <= 50;
                    message = messages.experience;
                }

                const messageElement = input.parentElement.nextElementSibling;
                messageElement.textContent = isValid ? '' : message;
                input.classList.toggle('invalid', !isValid);
                return isValid;
            }

            // Add validation to inputs
            document.querySelectorAll('input[data-validate]').forEach(input => {
                input.addEventListener('input', () => validateInput(input));
                input.addEventListener('blur', () => validateInput(input));
            });

            // Step navigation
            function showStep(stepNumber) {
                steps.forEach(step => {
                    step.classList.remove('active');
                    if (step.dataset.step === stepNumber.toString()) {
                        step.classList.add('active');
                    }
                });

                progressSteps.forEach(step => {
                    step.classList.remove('active');
                    if (parseInt(step.dataset.step) <= stepNumber) {
                        step.classList.add('active');
                    }
                });
            }

            // Next step button handlers
            document.querySelectorAll('.next-step').forEach(button => {
                button.addEventListener('click', function() {
                    const currentStep = this.closest('.form-step');
                    const inputs = currentStep.querySelectorAll('input[data-validate], select[required]');
                    let isValid = true;

                    inputs.forEach(input => {
                        if (input.dataset.validate) {
                            isValid = validateInput(input) && isValid;
                        } else if (input.required && !input.value) {
                            isValid = false;
                            input.classList.add('invalid');
                        }
                    });

                    if (isValid) {
                        const nextStep = parseInt(currentStep.dataset.step) + 1;
                        showStep(nextStep);
                    }
                });
            });

            // Previous step button handlers
            document.querySelectorAll('.prev-step').forEach(button => {
                button.addEventListener('click', function() {
                    const currentStep = this.closest('.form-step');
                    const prevStep = parseInt(currentStep.dataset.step) - 1;
                    showStep(prevStep);
                });
            });

            // Form submission
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Collect form data
                const formData = {
                    name: document.getElementById('name').value,
                    age: parseInt(document.getElementById('age').value),
                    email: document.getElementById('email').value,
                    phone: document.getElementById('phone').value,
                    occupation: document.getElementById('occupation').value,
                    experience: document.getElementById('experience').value,
                    city: document.getElementById('city').value,
                    incomeRange: document.getElementById('income-range').value,
                    goals: Array.from(document.querySelectorAll('input[name="goals"]:checked'))
                        .map(cb => cb.value)
                };

                // Save to AppState
                AppState.personalInfo = formData;
                AppState.save();

                // Show navigation after form submission
                navLinks.style.display = 'flex';

                // Redirect to next step
                window.location.href = 'networth.html';
            });

            // Check if user has already completed onboarding
            const userState = AppState.personalInfo;
            if (userState && userState.name) {
                // Show navigation if user has already completed onboarding
                navLinks.style.display = 'flex';
                
                // Pre-fill form with existing data
                document.getElementById('name').value = userState.name || '';
                document.getElementById('age').value = userState.age || '';
                document.getElementById('email').value = userState.email || '';
                document.getElementById('phone').value = userState.phone || '';
                document.getElementById('occupation').value = userState.occupation || '';
                document.getElementById('experience').value = userState.experience || '';
                document.getElementById('city').value = userState.city || '';
                document.getElementById('income-range').value = userState.incomeRange || '';
                
                if (userState.goals) {
                    userState.goals.forEach(goal => {
                        const checkbox = document.querySelector(`input[value="${goal}"]`);
                        if (checkbox) checkbox.checked = true;
                    });
                }
            }
        });
    </script>

    <style>
        /* Multi-step Form Styles */
        .multi-step-form .form-step {
            display: none;
        }

        .multi-step-form .form-step.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        /* Progress Steps */
        .onboarding-progress {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2rem;
            padding: 0 1rem;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
            flex: 1;
            padding: 1rem;
            opacity: 0.5;
            transition: all 0.3s ease;
        }

        .progress-step::after {
            content: '';
            position: absolute;
            top: 50%;
            right: 0;
            width: 100%;
            height: 2px;
            background-color: var(--border-color);
            transform: translateY(-50%);
            z-index: -1;
        }

        .progress-step:last-child::after {
            display: none;
        }

        .progress-step.active {
            opacity: 1;
        }

        .progress-step.active .step-icon {
            background-color: var(--primary-color);
            color: white;
        }

        .step-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--bg-tertiary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .step-content {
            display: flex;
            flex-direction: column;
        }

        .step-label {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .step-desc {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        /* Form Layout */
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .input-group {
            position: relative;
            display: flex;
            align-items: center;
        }

        .input-icon {
            position: absolute;
            left: 1rem;
            color: var(--text-secondary);
        }

        .input-group input,
        .input-group select {
            padding-left: 2.5rem;
        }

        /* Goals Grid */
        .goals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .goal-card {
            position: relative;
        }

        .goal-card input[type="checkbox"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .goal-card label {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1.5rem;
            background-color: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            height: 100%;
        }

        .goal-card label i {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        .goal-card label h3 {
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .goal-card label p {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin: 0;
        }

        .goal-card input[type="checkbox"]:checked + label {
            background-color: var(--bg-accent);
            border-color: var(--primary-color);
        }

        .goal-card input[type="checkbox"]:checked + label i {
            color: var(--primary-color);
        }

        /* Validation Styles */
        .validation-message {
            display: block;
            font-size: 0.875rem;
            color: var(--danger-color);
            margin-top: 0.25rem;
            min-height: 1.25rem;
        }

        input.invalid,
        select.invalid {
            border-color: var(--danger-color);
        }

        input.invalid + .input-icon {
            color: var(--danger-color);
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .onboarding-progress {
                flex-direction: column;
                gap: 1rem;
            }

            .progress-step::after {
                width: 2px;
                height: 100%;
                top: 50%;
                left: 20px;
            }

            .progress-step {
                padding-left: 3rem;
            }

            .step-icon {
                position: absolute;
                left: 0;
            }

            .goals-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</body>
</html> 